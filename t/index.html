<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Redirect</title>
</head>
<body>
  <script>
    // Get the "id" and "redirect" query parameters
    const id = getParameterByName("id");
    const redirect = getParameterByName("redirect");
    const urlKey = redirect.replace(/[^a-zA-Z0-9\-]/g, "-");

    fetch(`https://url-tracker-f404e-default-rtdb.firebaseio.com/tracker/${id}`, {
      method: "PUT",
      body: JSON.stringify({ [urlKey]: 1 }),
      headers: {
        "Content-Type": "application/json"
    }
    })
    .then(response => response.json())
    .then(data => console.log(data))
    .catch(error => console.error(error));

    // Redirect the user to the "redirect" URL
    window.location.href = redirect;

    // Helper function to get a query parameter by name
    function getParameterByName(name) {
      name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
      const regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
      const results = regex.exec(location.search);
      return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
  </script>
</body>
</html>
